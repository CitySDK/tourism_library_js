<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		<title>Insert title here</title>
		<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/2.0.0/jquery.min.js"></script>
		<script type="text/javascript" src="bin/jquery.citysdk-tourism.min.js" ></script>
		
		<!--
		<script type="text/javascript" src="src/jquery.citysdk-tourism.datareader.js" ></script>
		<script type="text/javascript" src="src/jquery.citysdk-tourism.stub.js" ></script>
		<script type="text/javascript" src="src/jquery.citysdk-tourism.uritemplate.js" ></script>
		-->
	</head>
	<body>
		<script type="text/javascript">
			$(document).ready(function() {
				init("http://polar-lowlands-9873.herokuapp.com/?list=backend");
			});

			// make the call
			function init(uri) {
				// handleVisit is the callback for a success call, handleError for error situations
				TourismVisitor.visit(uri, handleVisit, handleError);
			}

			// method to handle the erroneous calls
			// its parameters are similar to an Ajax call
			function handleError(jqXHR, textStatus, errorThrown) {
				console.log(jqXHR, errorThrown, textStatus);
			}

			// method to handle the data
			// in this case it will receive the client as a first parameter
			function handleVisit(client, textStatus, jqXHR) {
				var mClient = client, categories = ["music", "live"], tags = "rock", show = [0, 19],
				// initialize the wanted parameters
				parameters = {
					"category" : categories,
					"tag" : tags,
					"show" : show
				};

				mClient.useVersion("1.0");
				mClient.getPois(parameters, handlePois, handleError);
				mClient.getCategories(parameterTerms.POIS, handleCategories, handleError);
			}

			// method to handle the data
			// in this case it will receive a Category list as a first parameter
			function handleCategories(data, textStatus, jqXHR) {
				var categories = data;
				console.log(categories);
			}

			// method to handle the data
			// in this case it will receive a list of POIs as a first parameter
			function handlePois(data, textStatus, jqXHR) {
				var list = data.poi, poi, content, label, description, img, imgContent, thumbnail, imgUri, image;

				// set the default language to en_GB. If this method is not called
				// its default is en_GB
				DataReader.setDefaultLanguage("en_GB");
				// go through the list of events
				for (key in list) {
					poi = list[key];

					// get the primary label in PT language
					content = DataReader.getLabel(poi, term.LABEL_TERM_PRIMARY, "pt_PT");
					label = content.getContent();

					// get a description in PT language
					content = DataReader.getDescription(poi, "pt_PT");
					description = content.getContent();

					// get a thumbnail (URI or base-64 image)
					img = DataReader.getThumbnails(poi);
					imgContent = null;
					thumbnail = "";
					if (img.length > 0) {
						imgContent = img[0];
						thumbnail = imgContent.getContent();
					}

					// get an image (always a URI)
					imgUri = DataReader.getImagesUri(poi);
					image = null;
					if (imgUri.length > 0)
						image = imgUri.getContent();

					// print values
					console.log("Label: " + label);
					console.log("Description: " + description);
					if (imgContent != null) {
						console.log("THUMBNAIL (URI?: " + imgContent.hasImgUri() + ")" + ";(BYTE-CODE?: " + imgContent.hasImgByteCode() + ") : " + thumbnail);
					} else {
						console.log("THUMBNAIL: " + thumbnail);
					}
					console.log("IMAGE: " + image);
				}
			}

		</script>
	</body>
</html>