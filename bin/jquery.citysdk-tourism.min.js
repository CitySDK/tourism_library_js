var term={AUTHOR_TERM_PRIMARY:"primary",AUTHOR_TERM_SECONDARY:"secondary",AUTHOR_TERM_CONTRIBUTER:"contributer",AUTHOR_TERM_EDITOR:"editor",AUTHOR_TERM_PUBLISHER:"publisher",LABEL_TERM_PRIMARY:"primary",LABEL_TERM_NOTE:"note",TIME_TERM_START:"start",TIME_TERM_END:"end",TIME_TERM_INSTANT:"instant",TIME_TERM_OPEN:"open",LINK_TERM_SOURCE:"source",LINK_TERM_ALTERNATE:"alternate",LINK_TERM_CANONICAL:"canonical",LINK_TERM_COPYRIGHT:"copyright",LINK_TERM_DESCRIBEDBY:"describedby",LINK_TERM_EDIT:"edit",LINK_TERM_ENCLOSURE:"enclosure",LINK_TERM_ICON:"icon",LINK_TERM_LATEST_VERSION:"latest-version",LINK_TERM_LICENSE:"license",LINK_TERM_RELATED:"related",LINK_TERM_SEARCH:"search",LINK_TERM_PARENT:"parent",LINK_TERM_CHILD:"child",LINK_TERM_HISTORIC:"historic",LINK_TERM_FUTURE:"future",POINT_TERM_CENTER:"center",POINT_TERM_NAVIGATION_POINT:"navigation point",POINT_TERM_ENTRANCE:"entrance",RELATIONSHIP_TERM_EQUALS:"equals",RELATIONSHIP_TERM_DISJOINT:"disjoint",RELATIONSHIP_TERM_CROSSES:"crosses",RELATIONSHIP_TERM_OVERLAPS:"overlaps",RELATIONSHIP_TERM_WITHIN:"within",RELATIONSHIP_TERM_CONTAINS:"contains",RELATIONSHIP_TERM_TOUCHES:"touches"};function DataReader(){}DataReader.langsAreEqual=function(d,c){if(d==undefined||c==undefined){return false}var b=d.replace("-","_").split("_"),a=c.replace("-","_").split("_");return b[0]==a[0]};DataReader.loadMimeTypes=function(){if(this.mimeTypes==undefined){this.mimeTypes=[];this.mimeTypes["image/bmp"]="image/bmp";this.mimeTypes["image/cis-cod"]="image/cis-cod";this.mimeTypes["image/gif"]="image/gif";this.mimeTypes["image/ief"]="image/ief";this.mimeTypes["image/jpeg"]="image/jpeg";this.mimeTypes["image/pipeg"]="image/pipeg";this.mimeTypes["image/svg+xml"]="image/svg+xml";this.mimeTypes["image/tiff"]="image/tiff";this.mimeTypes["image/x-cmu-raster"]="image/x-cmu-raster";this.mimeTypes["image/x-cmx"]="image/x-cmx";this.mimeTypes["image/x-icon"]="image/x-icon";this.mimeTypes["image/x-portable-anymap"]="image/x-portable-anymap";this.mimeTypes["image/x-portable-bitmap"]="image/x-portable-bitmap";this.mimeTypes["image/x-portable-graymap"]="image/x-portable-graymap";this.mimeTypes["image/x-portable-pixmap"]="image/x-portable-pixmap";this.mimeTypes["image/x-rgb"]="image/x-rgb";this.mimeTypes["image/x-xbitmap"]="image/x-xbitmap";this.mimeTypes["image/x-xpixmap"]="image/x-xpixmap";this.mimeTypes["image/x-xwindowdump"]="image/x-xwindowdump"}};DataReader.getLocalLanguage=function(){if(navigator.userLanguage){return navigator.userLanguage.replace("-","_")}else{if(navigator.language){return navigator.language.replace("-","_")}else{return"en"}}};function DataContent(a){this.content=a;this.setContent=function(b){this.content=b};this.getContent=function(){return this.content}}function ImageContent(a){this.setContent(a);this.imgByteCode=false;this.imgUri=false;this.hasImgByteCode=function(){return this.imgByteCode};this.isImgByteCode=function(b){this.imgByteCode=b};this.hasImgUri=function(){return this.imgUri};this.isImgUri=function(b){this.imgUri=b}}ImageContent.prototype=new DataContent;function LocationContent(b,a){this.latitude=b;this.longitude=a;this.getLatitude=function(){return this.latitude};this.getLongitude=function(){return this.longitude}}function GeometryContent(){this.getNumGeo=function(){return 0}}function PointContent(b,a){this.location=new LocationContent(b,a);this.getLocation=function(){return this.location};this.getNumGeo=function(){return 1}}PointContent.prototype=new GeometryContent;function LineContent(b,a){this.pointOne=b;this.pointTwo=a;this.getPointOne=function(){return this.pointOne};this.getPointTwo=function(){return this.pointTwo};this.getNumGeo=function(){return 2}}LineContent.prototype=new GeometryContent;function PolygonContent(){this.values=[];this.getValues=function(){return this.values};this.addLocation=function(a){this.values.push(a)};this.getNumGeo=function(){return this.values.length}}PolygonContent.prototype=new GeometryContent;DataReader.getAvailableLanguages=function(c){var d=c.label,a=[],b;for(key in d){b=d[key].lang.replace("-","_");a[b.split("_")[0]]=b}return a};DataReader.setDefaultLanguage=function(a){if(a==null){return}this.defaultLanguage=a};DataReader.getLabel=function(f,b,e){if(f==null){return new DataContent(null)}if(this.defaultLanguage==undefined){this.setDefaultLanguage("en_GB")}var c,d=f.lang,g=f.label,a=null;for(key in g){if(g[key].lang==undefined){c=d}else{c=g[key].lang}if(g[key].term==b&&this.langsAreEqual(c,this.defaultLanguage)){a=g[key].value}else{if(g[key].term==b&&this.langsAreEqual(c,e)){return new DataContent(g[key].value)}}}return new DataContent(a)};DataReader.getDescription=function(f,e){if(f==null){return new DataContent(null)}if(this.defaultLanguage==undefined){this.setDefaultLanguage("en_GB")}var c,d=f.lang,b=f.description,a=null;for(key in b){if(b[key].lang==undefined){c=d}else{c=b[key].lang}if((b[key].type==undefined||b[key].type==null)&&this.langsAreEqual(c,this.defaultLanguage)){a=b[key].value}else{if((b[key].type==undefined||b[key].type==null)&&this.langsAreEqual(c,e)){return new DataContent(b[key].value)}}}return new DataContent(a)};DataReader.getPrice=function(b,a){return this.getValueWithTag(b,a,"X-citysdk/price")};DataReader.getWaitingTime=function(a){return this.getValueWithTag(a,null,"X-citysdk/waiting-time")};DataReader.getOccupation=function(b,a){return this.getValueWithTag(b,null,"X-citysdk/occupation")};DataReader.getValueWithTag=function(g,f,a){if(g==null){return new DataContent(null)}if(this.defaultLanguage==undefined){this.setDefaultLanguage("en_GB")}var d,e=g.lang,c=g.description,b=null;for(key in c){if(c[key].lang==undefined){d=e}else{d=c[key].lang}if(c[key].type!=undefined&&c[key].type==a){if(f==null||this.langsAreEqual(d,this.defaultLanguage)){b=c[key].value}}else{if(c[key].type!=undefined&&c[key].type==a){if(f==null||this.langsAreEqual(d,this.defaultLanguage)){return new DataContent(c[key].value)}}}}return new DataContent(b)};DataReader.getThumbnails=function(c){var d=[],a,b;if(c==null){return d}a=c.link;for(key in a){if(a[key].term==term.LINK_TERM_ICON){if(a[key].href!=undefined){b=new ImageContent(a[key].href);b.isImgUri(true);d.push(b)}else{if(a[key].value!=undefined){b=new ImageContent(a[key].value);b.isImgByteCode(true);d.push(b)}}}}return d};DataReader.getLocationPoint=function(g,c){var f=[],b,a,e,d;if(g==null){return f}b=g.location;if(b.point!=undefined){d=b.point;for(key in d){if(d[key].term==c){e=[];e=d[key].Point.posList.split(" ");a=new PointContent(new DataContent(e[0]),new DataContent(e[1]));f.push(a)}}}return f};DataReader.getLocationLine=function(a,b){var d=[],g,i,c,f,e,h;if(a==null){return d}g=a.location;if(g.line!=undefined){h=g.line;for(key in h){if(h[key].term==b){c=[];f=[];e=[];c=h[key].LineString.posList.split(",");f=c[0].split(" ");e=c[1].split(" ");i=new LineContent(new LocationContent(new DataContent(f[0]),new DataContent(f[1])),new LocationContent(new DataContent(e[2]),new DataContent(e[3])));d.push(i)}}}return d};DataReader.getLocationPolygon=function(a,b){var e=[],j,g,h,d,f,c;if(a==null){return e}j=a.location;if(j.polygon!=undefined){h=j.polygon;for(key in h){if(h[key].term==b){g=new PolygonContent();d=[];d=h[key].SimplePolygon.posList.split(",");for(c=0;c<d.length;c++){f=d[c].split(" ");g.addLocation(new LocationContent(new DataContent(f[0]),new DataContent(f[1])))}e.push(g)}}}return e};DataReader.getLocationGeometry=function(e,c){var d=[],a,f,b;if(e==null){return d}a=DataReader.getLocationPoint(e,c);f=DataReader.getLocationLine(e,c);b=DataReader.getLocationPolygon(e,c);d=a.concat(f,b);return d};DataReader.getContacts=function(b){if(b==null){return new DataContent(null)}var a=b.location;if(a==undefined||(a!=undefined&&a.address==undefined)){return new DataContent(null)}else{return new DataContent(a.address.value)}};DataReader.getCalendar=function(c,a){if(c==null){return new DataContent(null)}var b=c.time;for(key in b){if(b[key].type=="text/icalendar"&&b[key].term==a){return new DataContent(b[key].value)}}return new DataContent(null)};DataReader.getImagesUri=function(d){var c=[],a,b;if(d==null){return c}this.loadMimeTypes();a=d.link;for(key in a){if(a[key].term==term.LINK_TERM_RELATED&&this.mimeTypes[a[key].type]!=undefined){b=new ImageContent(a[key].href);b.isImgUri(true);c.push(b)}}return c};DataReader.getRelationshipBase=function(c,b){if(c==null){return new DataContent(null)}var a=c.location,d;if(a.relationship!=undefined){d=a.relationship;for(key in d){if(d[key].term==b){return new DataContent(d[key].base)}}}return new DataContent(null)};DataReader.getRelationshipId=function(c,b){if(c==null){return new DataContent(null)}var a=c.location,d;if(a.relationship!=undefined){d=a.relationship;for(key in d){if(d[key].term==b){if(d[key].targetPOI!=undefined){return new DataContent(d[key].targetPOI)}else{return new DataContent(d[key].targetEvent)}}}}return new DataContent(null)};DataReader.getLink=function(c,b){if(c==null){return new DataContent(null)}var a=c.link;for(key in a){if(a[key].term==b){return new DataContent(a[key].href)}}return new DataContent(null)};var resourceTerms={RESOURCE_POIS:{FIND_POI:"find-poi",FIND_POI_RELATION:"find-poi-relation"},RESOURCE_EVENTS:{FIND_EVENT:"find-event",FIND_EVENT_RELATION:"find-event-relation"},RESOURCE_ROUTES:{FIND_ROUTE:"find-route",},FIND_CATEGORIES:"find-categories",FIND_TAGS:"find-tags"},parameterTerms={POIS:"poi",EVENTS:"event",ROUTES:"route",SEARCH_PARAMETERS:{BASE:"base",ID:"id",CATEGORY:"category",TAG:"tag",COMPLETE:"complete",MINIMAL:"minimal",COORDS:"coords",CODE:"code",SHOW:"show",EVENT:"event",TIME:"time",ROUTE:"route",RELATION:"relation",LIST:"list"}};TourismClient=function(c){var b=d(c),a;function d(f){var e=f["citysdk-tourism"],g=[];for(key in e){g[e[key].version]=e[key]["_links"]}return g}this.useVersion=function(e){a=e};this.getResources=function(){verifyVersion();return Object.keys(b[a])};this.hasResource=function(e){verifyVersion();return e in b[a]};this.hasResourceParameter=function(e,f){verifyVersion();UriTemplate.fromTemplate(b[a][e].href);return UriTemplate.hasParameter(f)};this.getPois=function(f,e,g){getList(f,e,g,resourceTerms.RESOURCE_POIS.FIND_POI)};this.getEvents=function(f,e,g){getList(f,e,g,resourceTerms.RESOURCE_EVENTS.FIND_EVENT)};this.getRoutes=function(f,e,g){getList(f,e,g,resourceTerms.RESOURCE_ROUTES.FIND_ROUTE)};this.getCategories=function(f,e,g){getCategorization(f,e,g,resourceTerms.FIND_CATEGORIES)};this.getTags=function(f,e,g){getCategorization(f,e,g,resourceTerms.FIND_TAGS)};this.getPoi=function(f,h,e,g){makeSingleCall(f+h,e,g)};this.getEvent=function(f,h,e,g){makeSingleCall(f+h,e,g)};this.getRoute=function(f,h,e,g){makeSingleCall(f+h,e,g)};this.getPoiRelation=function(g,i,f,e,h){getRelation(g,i,f,e,h,resourceTerms.RESOURCE_POIS.FIND_POI_RELATION)};this.getEventRelation=function(g,i,f,e,h){getRelation(g,i,f,e,h,resourceTerms.RESOURCE_EVENTS.FIND_EVENT_RELATION)};getList=function(f,e,h,g){verifyVersion();validateResource(g);validateParameters(g,f);makeQueryCall(b[a][g].href,f,e,h)};getCategorization=function(f,e,i,h){verifyVersion();validateResource(h);validateListTerm(f);var g={list:f,};makeQueryCall(b[a][h].href,g,e,i)};getRelation=function(i,k,g,e,j,h){verifyVersion();validateResource(h);validateRelationTerm(g);var f={base:i,id:k,relation:term};makeQueryCall(b[a][h].href,f,e,j)};makeQueryCall=function(g,f,e,h){UriTemplate.fromTemplate(g);$.support.cors=true;$.ajax({headers:{Accept:"application/json"},crossDomain:true,dataType:"json",url:UriTemplate.build(f),type:"GET",processData:true,success:function(j,k,i){e(j,k,i)},error:function(i,k,j){h(i,k,j)}})};makeSingleCall=function(e,f,g){$.support.cors=true;$.ajax({headers:{Accept:"application/json"},crossDomain:true,url:e,dataType:"json",type:"GET",success:function(i,j,h){f(i,j,h)},error:function(h,j,i){g(h,j,i)}})};verifyVersion=function(){if(a==undefined||b[a]==undefined){throw {name:"VersionNotAvailableException",level:"Show Stopper",message:a+" is not available"}}};validateResource=function(e){if(!(e in b[a])){throw {name:"ResourceNotAvailableException",level:"Show Stopper",message:e+" is not available"}}};validateParameters=function(f,e){UriTemplate.fromTemplate(b[a][f].href);for(key in e){if(!UriTemplate.hasParameter(key)){throw {name:"InvalidParameterException",level:"Show Stopper",message:key+" parameter is invalid for resource "+f}}}};validateListTerm=function(e){if(e==undefined||(e!=parameterTerms.POIS&&e!=parameterTerms.EVENTS&&e!=parameterTerms.ROUTES)){throw {name:"InvalidTermException",level:"Show Stopper",message:e+" is invalid. It should be either poi, event or route"}}};validateRelationTerm=function(e){if(e==undefined){throw {name:"InvalidTermException",level:"Show Stopper",message:e+" is invalid. It should be either child or parent."}}if(e==undefined||(e!="child"&&e!="parent")){throw {name:"InvalidTermException",level:"Show Stopper",message:e+" is invalid. It should be either child or parent."}}}};function TourismVisitor(){}TourismVisitor.visit=function(b,a,c){$.support.cors=true;$.ajax({headers:{Accept:"application/json"},crossDomain:true,dataType:"json",url:b,type:"GET",success:function(e,f,d){a(new TourismClient(e),f,d)},error:function(d,f,e){c(d,f,e)}})};var operator={DEFAULT_OP:{value:"",operator:"",separator:",",named:false},PLUS_OP:{value:"+",operator:"",separator:",",named:false},SHARP_OP:{value:"#",operator:"#",separator:",",named:false},DOT_OP:{value:".",operator:".",separator:".",named:false},SLASH_OP:{value:"/",operator:"/",separator:"/",named:false},SEMICOLON_OP:{value:";",operator:";",separator:";",named:true},QUERY_OP:{value:"?",operator:"?",separator:"&",named:true},FORM_OP:{value:"&",operator:"&",separator:"&",named:true}};UriTemplate=function(){var b,a};UriTemplate.fromTemplate=function(a){this.template=a;this.operators=[];this.operators[""]=operator.DEFAULT_OP;this.operators["+"]=operator.PLUS_OP;this.operators["#"]=operator.SHARP_OP;this.operators["."]=operator.DOT_OP;this.operators["/"]=operator.SLASH_OP;this.operators[";"]=operator.SEMICOLON_OP;this.operators["?"]=operator.QUERY_OP;this.operators["&"]=operator.FORM_OP};UriTemplate.hasParameter=function(e){var d=/{[^{}]+}/g,c=/((?:\w+))/g,a,b;while(a=d.exec(this.template)){template=a[0];while(b=c.exec(template)){if(b[0]==e){return true}}}return false};UriTemplate.build=function(d){var p=/{[^{}]+}/g,c=/((?:\w+))/g,i,l,g=this.template,h="",a,r,k;while(i=p.exec(this.template)){r=i[0];op=this.operators[r.substring(1,2)];h+=op.operator;while(l=c.exec(r)){a=r.charAt(l.index+l[0].length);if(a=="*"){h+=n(l[0],op)}else{if(a==":"){k=c.exec(r);h+=s(l[0],k[0],op)}else{h+=b(l[0],op)}}}if(op.separator&&o(h,op.separator)){h=h.substring(0,h.length-1)}g=g.replace(r,h)}return g.replace(/\ /g,"%20");function o(v,u){return v.indexOf(u,v.length-u.length)!==-1}function b(v,w){var u="";if(d[v]!=undefined){if(f(e(d[v]))){u+=q(v,w,d[v])}else{if(j(e(d[v]))){u+=m(v,w,d[v])}}}return u}function s(y,w,z){var x="",u;if(d[y]!=undefined){u=d[y].substring(0,parseInt(w));if(z.named){x+=y+"="+u}else{x+=u}x+=z.separator}return x}function n(v,w){var u="";if(d[v]!=undefined){if(f(e(d[v]))){u+=q(v,w,d[v])}else{if(j(e(d[v]))){u+=t(v,w,d[v])}}}return u}function q(v,x,w){var u="";if(x.named){u+=v+"="+w}else{u+=w}u+=x.separator;return u}function m(v,y,x){var u="",w=",";if(y.named){u+=v+"="}for(key in x){ob=x[key];if(!isNaN(key)){u+=ob.toString()+w}else{u+=key.toString()+","+ob.toString()+w}}u=u.substring(0,u.length-1);u+=y.separator;return u}function t(w,z,y){var v="",x=z.separator,u;for(key in y){u=y[key];if(!isNaN(key)){if(z.named){v+=w+"="+u.toString()+x}else{v+=u.toString()+x}}else{if(z.named){v+=key.toString()+"="+u.toString()+x}else{v+=key.toString()+z.separator+u.toString()+x}}}v=v.substring(0,v.length-1);v+=z.separator;return v}function f(u){return u=="string"||u=="number"||u=="boolean"}function j(u){return u=="array"}function e(u){return({}).toString.call(u).match(/\s([a-zA-Z]+)/)[1].toLowerCase()}};